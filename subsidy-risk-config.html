<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>补贴风险指标配置</title>
  <style>
    :root {
      --primary-blue: #1677ff;
      --primary-blue-hover: #4096ff;
      --primary-blue-active: #0958d9;
      --primary-blue-light: #e6f4ff;
      --success-green: #52c41a;
      --warning-orange: #fa8c16;
      --error-red: #ff4d4f;
      --bg-layout: #f5f5f5;
      --bg-container: #ffffff;
      --border-color: #d9d9d9;
      --border-color-light: #f0f0f0;
      --text-primary: #000000d9;
      --text-secondary: #00000073;
      --text-disabled: #00000040;
      --shadow-card: 0 1px 2px 0 rgba(0, 0, 0, 0.03), 0 1px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px 0 rgba(0, 0, 0, 0.02);
    }
    * { font-family: 'PingFang SC', 'Microsoft YaHei', system-ui, -apple-system, sans-serif; }
    body { background: var(--bg-container); color: var(--text-primary); font-size: 14px; line-height: 1.5715; margin: 0; padding: 24px; padding-bottom: 80px; }
    .config-header { margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border-color-light); }
    .config-description { color: var(--text-secondary); margin: 0; }

    .tag-list { display: flex; flex-direction: column; gap: 8px; }
    
    .configurable-item {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      border: 1px solid var(--border-color-light);
      border-radius: 8px;
      margin-bottom: 8px;
      background: var(--bg-container);
      transition: all 0.2s ease;
    }

    .configurable-item:hover {
      border-color: var(--primary-blue);
      box-shadow: 0 2px 8px rgba(22, 119, 255, 0.1);
    }

    .configurable-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 16px;
      border: 1px solid #91caff;
      background: var(--primary-blue-light);
      color: var(--primary-blue);
      font-size: 12px;
      user-select: none;
      position: relative;
      min-width: 120px;
      min-height: 28px;
    }

    .config-panel {
      flex: 1;
      margin-left: 16px;
      padding-left: 16px;
      border-left: 1px solid var(--border-color-light);
    }

    .calc-info {
      background: var(--primary-blue-light);
      border: 1px solid #91caff;
      border-radius: 6px;
      padding: 10px 12px;
      color: var(--primary-blue);
      margin-bottom: 12px;
      font-size: 13px;
    }

    .risk-levels {
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 12px;
    }
    
    .threshold-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }
    
    .threshold-row label {
      width: 64px;
      font-weight: 500;
    }

    .risk-high {
      color: var(--text-primary);
    }

    .risk-medium {
      color: var(--text-primary);
    }

    .risk-low {
      color: var(--text-primary);
    }
    .module-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary-blue);
            display: inline-block;
        }

    .page-footer { position: fixed; bottom: 0; left: 0; right: 0; background: var(--bg-container); border-top: 1px solid var(--border-color-light); padding: 12px 16px; display: flex; align-items: center; gap: 12px; box-shadow: 0 -2px 8px rgba(0,0,0,0.1); z-index: 100; }
    .btn { display: inline-flex; align-items: center; justify-content: center; padding: 8px 16px; border-radius: 6px; font-size: 14px; font-weight: 500; text-decoration: none; border: 1px solid transparent; cursor: pointer; transition: all 0.2s ease; gap: 8px; }
    .btn-primary { background: var(--primary-blue); color: #fff; border-color: var(--primary-blue); }
    .btn-primary:hover { background: var(--primary-blue-hover); border-color: var(--primary-blue-hover); }
    .btn-default { background: var(--bg-container); color: var(--text-primary); border-color: var(--border-color); }
    .btn-default:hover { color: var(--primary-blue); border-color: var(--primary-blue); }
    .footer-count { flex: 1; color: var(--primary-blue); text-align: right; }
  </style>
</head>
<body>
  <div class="config-header">
    <p class="config-description">可快速查看本省分配的补贴预警指标</p>
  </div>
  <h3 class="module-title">默认指标</h3>
  <!-- 指标标签列表（仅不可配置） -->
  <div id="tagContainer" class="tag-list" aria-live="polite"></div>

  <!-- 固定底部操作栏 -->
  <div class="page-footer">
    <div style="flex: 1;"></div>
    <button class="btn btn-default" onclick="goBack()">返回</button>
    <!-- <button class="btn btn-primary" onclick="saveAllConfig()">保存</button> -->
  </div>

  <script>
    /**
     * 指标对象
     * @typedef {Object} Indicator
     * @property {number} id 指标ID
     * @property {string} name 指标名称
     * @property {boolean} enabled 是否启用（选择）
     */

    /** 模拟数据（补贴风险，全部不可配置） */
    const indicators = [
      { id: 101, name: '本月网点耗能预警', enabled: true, calc: '网点下当月累计消耗成本/预估当月收益，高度关注含预估当月0收益商户', high: {op: '>=', value: 150}, medium: {op: '>=', value: 90}, low: {op: '<', value: 90} },
      { id: 102, name: '上月网点耗能预警', enabled: false, calc: '网点下上月累计消耗成本/上月实际收益，高度关注含预估当月0收益商户', high: {op: '>=', value: 150}, medium: {op: '>=', value: 90}, low: {op: '<', value: 90} },
      { id: 103, name: '补贴激增预警', enabled: true, calc: '与上月同期消耗成本对比', high: {op: '>=', value: 150}, medium: {op: '>=', value: 90}, low: {op: '<', value: 90} },
      { id: 104, name: '本月全省耗能预警', enabled: false, calc: '全省网点下当月累计消耗成本/预估当月收益，高度关注含预估当月0收益商户', high: {op: '>=', value: 150}, medium: {op: '>=', value: 90}, low: {op: '<', value: 90} }
    ];

    document.addEventListener('DOMContentLoaded', () => {
      renderTagList();
    });

    /**
     * 渲染固定指标列表
     * @returns {void}
     */
    function renderTagList() {
      const container = document.getElementById('tagContainer');
      container.innerHTML = '';
      indicators.forEach(ind => {
        const configurableItem = document.createElement('div');
        configurableItem.className = 'configurable-item';
        
        // 标签区域
        const tag = document.createElement('div');
        tag.className = 'configurable-tag';
        
        const nameSpan = document.createElement('span');
        nameSpan.textContent = ind.name;
        tag.appendChild(nameSpan);
        
        // 配置面板区域
        const configPanel = document.createElement('div');
        configPanel.className = 'config-panel';
        
        const calcInfo = document.createElement('div');
        calcInfo.className = 'calc-info';
        calcInfo.textContent = `指标计算方式：${ind.calc}`;
        configPanel.appendChild(calcInfo);
        
        const riskLevels = document.createElement('div');
        riskLevels.className = 'risk-levels';
        riskLevels.innerHTML = `
          <div class="threshold-row">
            <label>高度关注：</label>
            <span class="risk-high">指标值${ind.high.op} ${ind.high.value}%</span>
          </div>
          <div class="threshold-row">
            <label>中度关注：</label>
            <span class="risk-medium">指标值${ind.medium.op} ${ind.medium.value}%</span>
          </div>
          <div class="threshold-row">
            <label>轻度关注：</label>
            <span class="risk-low">指标值${ind.low.op} ${ind.low.value}%</span>
          </div>
        `;
        configPanel.appendChild(riskLevels);
        
        configurableItem.appendChild(tag);
        configurableItem.appendChild(configPanel);
        container.appendChild(configurableItem);
      });
    }



    /**
     * 返回上一页/关闭弹窗（由父页面接管或直接关闭窗口）
     * @returns {void}
     */
    function goBack() { closePage(); }

    /**
     * 关闭当前页面（供父页面弹窗集成调用）
     * @returns {void}
     */
    function closePage() {
      if (window.parent && window.parent.closeIndicatorConfigModal) {
        window.parent.closeIndicatorConfigModal();
      } else {
        window.close();
      }
    }

    /**
     * 保存全部配置（示例内仅提示+关闭）
     * @returns {void}
     */
    function saveAllConfig() {
      console.log('保存配置：', indicators);
      alert('配置保存成功！');
      closePage();
    }
  </script>
</body>
</html>
